import   "60285d9396e3a5618f688ca4c3f6e989:@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";
import   "60285d9396e3a5618f688ca4c3f6e989:@babel/runtime/helpers/esm/extends";
import   "60285d9396e3a5618f688ca4c3f6e989:@babel/runtime/helpers/esm/inheritsLoose";
import   "60285d9396e3a5618f688ca4c3f6e989:react";
import   "60285d9396e3a5618f688ca4c3f6e989:react-lifecycles-compat";
import   "60285d9396e3a5618f688ca4c3f6e989:invariant";
import   "60285d9396e3a5618f688ca4c3f6e989:./utils";
var $60285d9396e3a5618f688ca4c3f6e989$var$_jsxFileName = "/Users/jquense/src/uncontrollable/src/uncontrollable.js";
function $60285d9396e3a5618f688ca4c3f6e989$export$9099ad97b570f7c(Component, controlledValues, methods) {
    if (methods === void 0) methods = [];
    var displayName = Component.displayName || Component.name || 'Component';
    var canAcceptRef = $60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$3c0199c0a5db6fb5(Component);
    var controlledProps = Object.keys(controlledValues);
    var PROPS_TO_OMIT = controlledProps.map($60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$c1bbfbf35033018d);
    !(canAcceptRef || !methods.length) && $60285d9396e3a5618f688ca4c3f6e989$import$5ae10ca03d5ba025$9099ad97b570f7c(false);
    var UncontrolledComponent1 = /*#__PURE__*/ function(_React$Component) {
        $60285d9396e3a5618f688ca4c3f6e989$import$8db3e3d0e0460463$9099ad97b570f7c(UncontrolledComponent2, _React$Component);
        function UncontrolledComponent2() {
            var _this;
            for(var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++)args[_key] = arguments[_key];
            _this = _React$Component.call.apply(_React$Component, [
                this
            ].concat(args)) || this;
            _this.handlers = Object.create(null);
            controlledProps.forEach(function(propName) {
                var handlerName = controlledValues[propName];
                var handleChange = function handleChange1(value) {
                    if (_this.props[handlerName]) {
                        var _this$props;
                        _this._notifying = true;
                        for(var _len2 = arguments.length, args1 = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++)args1[_key2 - 1] = arguments[_key2];
                        (_this$props = _this.props)[handlerName].apply(_this$props, [
                            value
                        ].concat(args1));
                        _this._notifying = false;
                    }
                    if (!_this.unmounted) _this.setState(function(_ref) {
                        var _extends2;
                        var values = _ref.values;
                        return {
                            values: $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c(Object.create(null), values, (_extends2 = {
                            }, _extends2[propName] = value, _extends2))
                        };
                    });
                };
                _this.handlers[handlerName] = handleChange;
            });
            if (methods.length) _this.attachRef = function(ref) {
                _this.inner = ref;
            };
            var values = Object.create(null);
            controlledProps.forEach(function(key) {
                values[key] = _this.props[$60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$c1bbfbf35033018d(key)];
            });
            _this.state = {
                values: values,
                prevProps: {
                }
            };
            return _this;
        }
        var _proto = UncontrolledComponent2.prototype;
        _proto.shouldComponentUpdate = function shouldComponentUpdate() {
            //let setState trigger the update
            return !this._notifying;
        };
        UncontrolledComponent2.getDerivedStateFromProps = function getDerivedStateFromProps(props, _ref2) {
            var values = _ref2.values, prevProps = _ref2.prevProps;
            var nextState = {
                values: $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c(Object.create(null), values),
                prevProps: {
                }
            };
            controlledProps.forEach(function(key) {
                /**
         * If a prop switches from controlled to Uncontrolled
         * reset its value to the defaultValue
         */ nextState.prevProps[key] = props[key];
                if (!$60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$9ae6a5b9e0a97d9e(props, key) && $60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$9ae6a5b9e0a97d9e(prevProps, key)) nextState.values[key] = props[$60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$c1bbfbf35033018d(key)];
            });
            return nextState;
        };
        _proto.componentWillUnmount = function componentWillUnmount() {
            this.unmounted = true;
        };
        _proto.render = function render() {
            var _this2 = this;
            var _this$props2 = this.props, innerRef = _this$props2.innerRef, props = $60285d9396e3a5618f688ca4c3f6e989$import$555fcbd5081a286a$9099ad97b570f7c(_this$props2, [
                "innerRef"
            ]);
            PROPS_TO_OMIT.forEach(function(prop) {
                delete props[prop];
            });
            var newProps = {
            };
            controlledProps.forEach(function(propName) {
                var propValue = _this2.props[propName];
                newProps[propName] = propValue !== undefined ? propValue : _this2.state.values[propName];
            });
            return $60285d9396e3a5618f688ca4c3f6e989$import$f02ba03fc070e88c$9099ad97b570f7c.createElement(Component, $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
            }, props, newProps, this.handlers, {
                ref: innerRef || this.attachRef
            }));
        };
        return UncontrolledComponent2;
    }($60285d9396e3a5618f688ca4c3f6e989$import$f02ba03fc070e88c$9099ad97b570f7c.Component);
    $60285d9396e3a5618f688ca4c3f6e989$import$2497fe33dc80be80$816f6e489e5bdbf8(UncontrolledComponent1);
    UncontrolledComponent1.displayName = "Uncontrolled(" + displayName + ")";
    UncontrolledComponent1.propTypes = $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
        innerRef: function innerRef() {
        }
    }, $60285d9396e3a5618f688ca4c3f6e989$import$4b1ea399deea6e65$90214ceb73a2186a(controlledValues, displayName));
    methods.forEach(function(method) {
        UncontrolledComponent1.prototype[method] = function $proxiedMethod() {
            var _this$inner;
            return (_this$inner = this.inner)[method].apply(_this$inner, arguments);
        };
    });
    var WrappedComponent = UncontrolledComponent1;
    if ($60285d9396e3a5618f688ca4c3f6e989$import$f02ba03fc070e88c$9099ad97b570f7c.forwardRef) {
        WrappedComponent = $60285d9396e3a5618f688ca4c3f6e989$import$f02ba03fc070e88c$9099ad97b570f7c.forwardRef(function(props, ref) {
            return $60285d9396e3a5618f688ca4c3f6e989$import$f02ba03fc070e88c$9099ad97b570f7c.createElement(UncontrolledComponent1, $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
            }, props, {
                innerRef: ref,
                __source: {
                    fileName: $60285d9396e3a5618f688ca4c3f6e989$var$_jsxFileName,
                    lineNumber: 128
                },
                __self: this
            }));
        });
        WrappedComponent.propTypes = UncontrolledComponent1.propTypes;
    }
    WrappedComponent.ControlledComponent = Component;
    /**
   * useful when wrapping a Component and you want to control
   * everything
   */ WrappedComponent.deferControlTo = function(newComponent, additions, nextMethods) {
        if (additions === void 0) additions = {
        };
        return $60285d9396e3a5618f688ca4c3f6e989$export$9099ad97b570f7c(newComponent, $60285d9396e3a5618f688ca4c3f6e989$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
        }, controlledValues, additions), nextMethods);
    };
    return WrappedComponent;
}
